var spdy = require('./');
var fs = require('fs');
var formidable = require('formidable');

var options = {
  key: "-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAy1Mogi0sHpx/rCQ3jJDuNTAVa4IjfnGWGkYKttNnNd2Zyjf6\npa+fJlOjLghSlnB4uDZCSVWLrjLAIGZopqxQ3jNSQDFyGaDGBFkVJ+u7qxzt/2MC\nlJt6aosyruCwSdcIxWnLLB3DCt43/juCWAnK/7sGpOV9CySJy7jRx7XQmPeF+EqL\nfWTP+9r8vqLfpFmz5mNetHwACGknjegQPzh/+tu4+xKIst1uPJFhJ694vNcPtLfr\nsWc2sE+pWApjfg7Ak6jMSG3LgvGZkmj5CXeEUuZ47mWLGo2MqgtQaUJrVP3zFtGM\nafP7HmEASIYPRQ1YHxxZfsSlhckoQDgkwOWXQQIDAQABAoIBAQCN5xTPfY1cM+cb\nEg++x+uoLU3VwXbaKZYT8ixKGtLekjFiI52IA0D0s8ygNOjG2+o0zpGGsvCQfBUA\nx9hj8sFhwrm12YyDfGSW5kFQokJRExi7c7N6WeSe9VVDHceLUUtq1AIbYQ4dyKeV\nhJzcqsEFp9bkQNH7c93D09J9KlRSXLa+dwVGampOfYrc0KHJUrcx9k2ge3gr26fm\nmV1vBi7+k1bADmQZjeJMCzAtpnWLHVeaukVayN9WkBi13jbasAceF/TtgGuozQp4\nnLEj9+5TZD+U8izExJlZTjjBOfHSgvcgPHs8PqUK6IiRvtdneaA6hItBjGkQIH+3\ngzuDjv0dAoGBANNo/zzuD114kF5TnupH0MNlCFaaZC5NC75SzbbVpDWyQ2wjZdrp\n9zVX0IAT7+c7ncjrtExs+fiWxYiarBkBf+DCXDpMQKcImsfSOjUvtLQO4/621plr\nJx9oz8PdtWEzcXlDHCghuNmY6EEJkpOF+eKis6eIEv2FcML2L2+BbNCbAoGBAPY1\nmS9DyC5l8RlNng0MUPeCSCqi7tQ3EfcXITMky2oncqF1/s7XPpOwJn20KkvGQ1do\nZ81KeF5hc+DeBBG9SDxoWvzppf3QEGb8Glwfsd0/s8/k+IV6q0CKhwM+RQR24DP7\nMRrHU+bLebOTHEpDA2iRPf9DUBSuLbbJY0oOTK9TAoGAOoXQUi+cdUWQwWvoi/ZB\nZjWrrz2iCecuHwuRAtH1WR/15hOOeKFX255pi2r5eEtajGojSRzJvfUOzZfzmCCA\nI9np6gF9zD9niXU6w8pm/Yk5uCMpGOM+u0UqbpALS9MP0H+xZbKgFyxq7sYVm1z1\nJbXggbn7d87evjmkO/vaAY0CgYAp/lZUU3FPSJ/ouu5cN1+P966rZwLpO0NbK5zE\nBmCTiIrqsx901A2eTwshoZsdNYHC5NHfl/YT0vdawUNcazZo5zutq4ReWCCUECfG\n0rkZjYXzzY/95EBVT8tbaEGJU2VGOG/Vq23KDaaCVHMcz3VDXpJ+eVKtVFADvzGq\nLeoydQKBgDlApjgsdfiBXOW2ThJHPx5VSMsCO8GkiWJQm+fq79xAZ7IBhY0mdLwO\nTnkZErQfvqPzgM9rr/eYZf4+Ul8xtkDa8jHuR8UZntVcMy28ck+s0OSIbPE1V9RE\nAuc1nfe4g3hQVrdHeyCHcOGZSZgFfOfW1s1qhVY/sjEMnzCPsWV6\n-----END RSA PRIVATE KEY-----",
  cert: "-----BEGIN CERTIFICATE-----\nMIICwjCCAaygAwIBAgIDAQABMAsGCSqGSIb3DQEBCzAXMRUwEwYDVQQDFgx0ZXN0\nLmluZHV0bnkwHhcNMTUwODEyMDMzNzQ1WhcNMjUwODEwMDMzNzQ1WjAXMRUwEwYD\nVQQDFgx0ZXN0LmluZHV0bnkwggEgMAsGCSqGSIb3DQEBAQOCAQ8AMIIBCgKCAQEA\ny1Mogi0sHpx/rCQ3jJDuNTAVa4IjfnGWGkYKttNnNd2Zyjf6pa+fJlOjLghSlnB4\nuDZCSVWLrjLAIGZopqxQ3jNSQDFyGaDGBFkVJ+u7qxzt/2MClJt6aosyruCwSdcI\nxWnLLB3DCt43/juCWAnK/7sGpOV9CySJy7jRx7XQmPeF+EqLfWTP+9r8vqLfpFmz\n5mNetHwACGknjegQPzh/+tu4+xKIst1uPJFhJ694vNcPtLfrsWc2sE+pWApjfg7A\nk6jMSG3LgvGZkmj5CXeEUuZ47mWLGo2MqgtQaUJrVP3zFtGMafP7HmEASIYPRQ1Y\nHxxZfsSlhckoQDgkwOWXQQIDAQABox0wGzAZBgNVHREEEjAQgg4qLnRlc3QuaW5k\ndXRueTALBgkqhkiG9w0BAQsDggEBAGYNi5CCq+/YmzH2Z7fgQ30oRdwvbn3MlM1F\nTrX33V+7Uu8bccABIrTXfOpWRMqREeygx4GvbffMvR1CnFGG5mxIEqaSSM9mBEBZ\nymlxiej6yCHAvPb3aG73Aa/bs55beOpXmRsMU3Ix9QhJzWOY6JDN0OBdSEuBBimE\n4jEnQOYczARbLKZJe7MenNo6dD7OKiwJGCFZBWFeCZBflqDm+HA5rUpG7EOi3Rr+\nGIABvRn+y0u4eVeEJBN4rWzNiMv44CD55PrbbNq9OQVIS3NmFScl4tQFDb0fgAdb\nR0ZtujqDjMY3uZZxtiu6CmBTUKhwF3tTn5sMV4Y6ZR9RgT/UEuQ=\n-----END CERTIFICATE-----"
};

spdy.createServer(options, function(req, res) {
  if (req.url === '/upload') {
    var form = new formidable.IncomingForm();
 
    form.parse(req, function(err, fields, files) {
      res.writeHead(200, {'content-type': 'text/plain'});
      res.write('received upload:\n\n');
      console.log(files);
      res.end();
    });
    return;
  }

  res.writeHead(200, {
    'Content-Type': 'text/html'
  });
  res.end('<form method=POST enctype="multipart/form-data" action="upload"><input name=file type=file /><button/></form>');
}).listen(1443);
